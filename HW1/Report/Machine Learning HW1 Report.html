<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Machine Learning HW1 Report - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-published-note{color:#337ab7}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style="position: relative;"><h1 id="Machine-Learning-HW1-Report"><a class="anchor hidden-xs" href="#Machine-Learning-HW1-Report" title="Machine-Learning-HW1-Report"><span class="octicon octicon-link"></span></a>Machine Learning HW1 Report</h1><p><em>Name and student ID: 張承遠 0616225</em></p><h2 id="Explanation-of-code"><a class="anchor hidden-xs" href="#Explanation-of-code" title="Explanation-of-code"><span class="octicon octicon-link"></span></a><strong>Explanation of code:</strong></h2><p><em>Train-Test-Split: First, implement two different method for spliting training data and testing data.</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Holdout_validation</span><span class="hljs-params">(self, ratio, way = <span class="hljs-string">"normal"</span>)</span>:</span>
        self.way = way
        train_set, train_label, test_set, test_label = self.Holdout_Handle(ratio)

        pred = self.execute(train_set, train_label, test_set, test_label)
        acc = self.cal_result(test_set, test_label, pred)
        <span class="hljs-keyword">if</span>(self.way == <span class="hljs-string">'normal'</span>):
            print(<span class="hljs-string">'Data {0} Accuracy by Holdout_validation: {1}% \n'</span>.format(self.file_name, acc))
        <span class="hljs-keyword">elif</span>(self.way == <span class="hljs-string">'smooth'</span>):
            print(<span class="hljs-string">'Data {0} Accuracy by Holdout_validation with laplace smooth: {1}% \n'</span>.format(self.file_name, acc))
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">k_fold_validation</span><span class="hljs-params">(self, k, way = <span class="hljs-string">"normal"</span>)</span>:</span>
        self.way = way
        acc = <span class="hljs-number">0.0</span>
        acc_list = []
        idx = k
        index = self.first
        <span class="hljs-keyword">while</span> idx:
            idx-=<span class="hljs-number">1</span>
            train_set, train_label, test_set, test_label = self.k_fold(k, idx)

            pred = self.execute(train_set, train_label, test_set, test_label)
            acc += self.cal_result(test_set, test_label, pred)
        acc /= float(k)
        <span class="hljs-keyword">if</span>(self.way == <span class="hljs-string">'normal'</span>):
            print(<span class="hljs-string">'Data {0} Average Accuracy by K-fold validation: {1}% \n'</span>.format(self.file_name, acc))
        <span class="hljs-keyword">elif</span>(self.way==<span class="hljs-string">'smooth'</span>):
            print(<span class="hljs-string">'Data {0} Average Accuracy by K-fold validation with laplace smooth: {1}% \n'</span>.format(self.file_name, acc))

        idx = k
implement k_fold validation
</code></pre><p><em>Implementation of k_fold validation</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">k_fold</span><span class="hljs-params">(self, k, idx)</span>:</span>
        self.file = self.file.reindex(np.random.permutation(self.file.index))

        seg_size = int(len(self.file) / k)

        set1 = self.file[:seg_size] 
        set2 = self.file[seg_size : <span class="hljs-number">2</span>*seg_size]
        set3 = self.file[<span class="hljs-number">2</span>*seg_size:]
        set_ = [set1, set2, set3]

        train_set = pd.DataFrame()
        <span class="hljs-comment">#allocate the trainset and testset</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):
            <span class="hljs-keyword">if</span> i==idx:
                test_set = set_[i]
            <span class="hljs-keyword">else</span>:
                train_set = train_set.append(set_[i])

        train_label = list(train_set.loc[:, <span class="hljs-string">"class"</span>])
        train_set = train_set.drop(<span class="hljs-string">"class"</span>, axis=<span class="hljs-number">1</span>)

        test_label = list(test_set.loc[:, <span class="hljs-string">"class"</span>])
        test_set = test_set.drop(<span class="hljs-string">"class"</span>, axis=<span class="hljs-number">1</span>)

        <span class="hljs-keyword">return</span> [train_set, train_label, test_set, test_label]
</code></pre><p><em>implementation for Holdout_Validation</em></p><pre><code class="python hljs">   <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Holdout_Handle</span><span class="hljs-params">(self, ratio)</span>:</span>
       self.file = self.file.reindex(np.random.permutation(self.file.index))
<span class="hljs-comment">#         self.file = self.file.reindex(np.random.permutation(self.file.index))</span>

       train_size = int(len(self.file) * ratio)

       train_set = self.file[:train_size]
       train_label = list(train_set.loc[:, <span class="hljs-string">"class"</span>])
       train_set = train_set.drop(<span class="hljs-string">"class"</span>, axis=<span class="hljs-number">1</span>)

       test_set = self.file[train_size:]
       test_label = list(test_set.loc[:, <span class="hljs-string">"class"</span>])
       test_set = test_set.drop(<span class="hljs-string">"class"</span>, axis=<span class="hljs-number">1</span>)

       <span class="hljs-keyword">return</span> [train_set, train_label, test_set, test_label]
</code></pre><p><em>Then, construct Naive Bayes Model and we can divide it to two parts:<br>
1.calculate the prior probability<br>
2.calculate posterior probability for testing data and do prediction that which class(label) it might belongs to</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">execute</span><span class="hljs-params">(self, train_set, train_label, test_set, test_label)</span>:</span>

        summaries = self.summarizeByClass(train_set, train_label)
        predictions = self.get_Prediction(summaries, test_set)
        <span class="hljs-keyword">return</span> predictions

</code></pre><p><em>Before calculating prior probability, we should separate the training data with different classes(labels) and its features.</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Separate_By_Class</span><span class="hljs-params">(self, train_set, train_label)</span>:</span>
        data = {}
        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(len(train_set)):
            typ = train_label[x]
            <span class="hljs-keyword">if</span> typ <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data:
                data[typ] = []
            li = []

            <span class="hljs-keyword">for</span> info <span class="hljs-keyword">in</span> train_set.iloc[x,:]:
                li.append(info)
            data[typ].append(li)

        <span class="hljs-keyword">return</span> data
</code></pre><p><em>To calculate prior probability,<br>
for numerical data, calculate the means and standard deviation for each feature because we use Gaussian distribution to calculate prior probability.<br>
for categorical data, calculate the prior probability for the appearance of attributes in each feature. Furthermore, there are two method to calculate prior probability: with laplace smooth and without it.</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">summarize_numerical</span><span class="hljs-params">(self, dataset)</span>:</span>
        summaries = [(statistics.mean(attr), statistics.stdev(attr)) <span class="hljs-keyword">for</span> attr <span class="hljs-keyword">in</span> zip(*dataset)]
        <span class="hljs-keyword">return</span> summaries
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">summarize_categorical</span><span class="hljs-params">(self, instances, classValue)</span>:</span>
        <span class="hljs-keyword">global</span> cnt2
        prob = []
        prob_with_laplace = []
        k = <span class="hljs-number">3</span>
        idx = <span class="hljs-number">0</span>;
        cnt2[classValue] = []
        ans_with_laplace = {}
        <span class="hljs-keyword">for</span> attr <span class="hljs-keyword">in</span> zip(*instances):
            ans = {}
            <span class="hljs-keyword">for</span> at <span class="hljs-keyword">in</span> attr:
                <span class="hljs-keyword">if</span> at <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ans:
                    ans[at] = <span class="hljs-number">0</span>
                ans[at] += <span class="hljs-number">1</span>
            <span class="hljs-comment">#copy</span>
            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ans.keys():
                <span class="hljs-keyword">if</span> self.way == <span class="hljs-string">"normal"</span>:
                    ans[x] /= float(len(attr))
                <span class="hljs-keyword">elif</span> self.way == <span class="hljs-string">"smooth"</span>:
                    ans[x] = (ans[x] + k) / float(len(attr) + k * torch[idx])

            prob.append(ans)            
            cnt2[classValue].append((len(attr)))
            idx += <span class="hljs-number">1</span>;

        <span class="hljs-keyword">return</span> prob
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">summarizeByClass</span><span class="hljs-params">(self, train_set, train_label)</span>:</span>
        sep = self.Separate_By_Class(train_set, train_label)
        summ = {}
        <span class="hljs-keyword">for</span> classValue, instances <span class="hljs-keyword">in</span> sep.items():
    <span class="hljs-comment">#         print(instances)</span>
            <span class="hljs-keyword">if</span> self.file_name == <span class="hljs-string">"iris"</span>:
                summ[classValue] = self.summarize_numerical(instances)
            <span class="hljs-keyword">elif</span> self.file_name == <span class="hljs-string">"mushroom"</span>:
                summ[classValue] = self.summarize_categorical(instances, classValue)
        <span class="hljs-keyword">return</span> summ

</code></pre><p><em>After calculating prior probability, we can do prediction by calculating posterior probability for testing data,<br>
for numerical data, calculate the posterior probability in log space with Gaussian Distribution<br>
for categorical data, calculate the posterior probability in log space<br>
Equation:</em><br>
<img src="https://i.imgur.com/lRLbOqH.png" alt=""></p><pre><code class="python hljs">
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Gaussian_Probability</span><span class="hljs-params">(self, x, mean, stdev)</span>:</span>
        exponent = math.exp(-(math.pow(x-mean, <span class="hljs-number">2</span>) / (<span class="hljs-number">2</span>*math.pow(stdev, <span class="hljs-number">2</span>))))
        a = ((<span class="hljs-number">1</span> / (math.sqrt(<span class="hljs-number">2</span>*math.pi) * stdev)) * exponent)
       
        <span class="hljs-keyword">return</span> ((<span class="hljs-number">1</span> / (math.sqrt(<span class="hljs-number">2</span>*math.pi) * stdev)) * exponent)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cal_numerical_probability</span><span class="hljs-params">(self, summaries, features)</span>:</span>
        prob = {}
        <span class="hljs-comment">#print(features)</span>
        <span class="hljs-keyword">for</span> classValue, classSummaries <span class="hljs-keyword">in</span> summaries.items():
            prob[classValue] = <span class="hljs-number">1</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(classSummaries)):
                mean, stdev = classSummaries[i]
                x = features[i]
                probability = self.Gaussian_Probability(x, mean, stdev)
                <span class="hljs-keyword">if</span> probability &gt; <span class="hljs-number">0</span>:
                    prob[classValue] += math.log(probability)
<span class="hljs-comment">#                 prob[classValue] *= (probability)</span>

        <span class="hljs-keyword">return</span> prob  

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cal_categorical_probability</span><span class="hljs-params">(self, summ, features)</span>:</span>
        prob = {}
        total = len(summ[<span class="hljs-string">'p'</span>]) + len(summ[<span class="hljs-string">'e'</span>])
        <span class="hljs-keyword">for</span> classValue <span class="hljs-keyword">in</span> summ.keys():
            prob[classValue] = <span class="hljs-number">0</span>
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(features)):
                x = features[j]
                <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> summ[classValue][j]:
                    <span class="hljs-keyword">if</span> self.way == <span class="hljs-string">"smooth"</span>:
                        prob[classValue] += math.log( (<span class="hljs-number">3</span> / float(cnt2[classValue][j] + <span class="hljs-number">3</span> * (torch[j]))) )
<span class="hljs-comment">#                     prob[classValue] = -9999999;</span>
                <span class="hljs-keyword">else</span>:
<span class="hljs-comment">#                     prob[classValue] *= (summ[classValue][j][x])</span>
                    prob[classValue] += math.log((summ[classValue][j][x]))

            prob[classValue] += math.log(len(summ[classValue]) / float(total))
<span class="hljs-comment">#             prob[classValue] *= len(summ[classValue]) / float(total)</span>

        <span class="hljs-keyword">return</span> prob
</code></pre><p><em>After calculating posterior probability, find the largest probability for each data and predict it belong to class(label) with largest probability</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict</span><span class="hljs-params">(self, summaries, features)</span>:</span>
        <span class="hljs-comment">#print(features)</span>
        <span class="hljs-keyword">if</span> self.file_name == <span class="hljs-string">"iris"</span>:
            prob = self.cal_numerical_probability(summaries, features)
        <span class="hljs-keyword">elif</span> self.file_name == <span class="hljs-string">"mushroom"</span>:
            prob = self.cal_categorical_probability(summaries, features)

        max_prob = <span class="hljs-number">-10000000</span>
        best_label = <span class="hljs-keyword">None</span>
        <span class="hljs-keyword">for</span> classValue, probability <span class="hljs-keyword">in</span> prob.items():
    <span class="hljs-comment">#         print(probability)</span>
            <span class="hljs-keyword">if</span> probability &gt; max_prob:
                max_prob = probability
                best_label = classValue
        <span class="hljs-keyword">return</span> best_label          

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_Prediction</span><span class="hljs-params">(self, summaries, testSet)</span>:</span>
        pred = []
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(testSet)):
            result = self.predict(summaries, list(testSet.iloc[i, :]))
            pred.append(result)
        <span class="hljs-keyword">return</span> pred
    


</code></pre><p><em>Calculate the confusion matrix so we can calculate accuracy, precison, and sensitivity.</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cal_result</span><span class="hljs-params">(self, test_set, test_label, prediction)</span>:</span>
        <span class="hljs-comment">#calculate confusion matrix, accuracy, precision, recall</span>
        correct = <span class="hljs-number">0</span>
        label = {}
        precision = {}
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(test_set)):
            T = test_label[i]
            P = prediction[i]
            <span class="hljs-keyword">if</span> T <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> label:
                label[T] = {}
            <span class="hljs-keyword">if</span> P <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> label[T]:
                label[T][P] = <span class="hljs-number">0</span>
            label[T][P] += <span class="hljs-number">1</span>
            
            <span class="hljs-keyword">if</span> T == P:
                correct += <span class="hljs-number">1</span>
        print(<span class="hljs-string">'Confusion Matrix parameters: '</span>)
        print(label)
        incorrect = len(test_set) - correct;
       
        acc = (correct / float(len(test_set))) * <span class="hljs-number">100.0</span>
        <span class="hljs-keyword">return</span> acc
</code></pre><p><em>plot the picture for two dataset</em></p><pre><code class="python hljs">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_feature_mushroom</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-comment">#value frequency</span>
        count_feat = {}
        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> self.file:
            count_feat = {}

            <span class="hljs-keyword">for</span> feat <span class="hljs-keyword">in</span> self.file.loc[:,x]:
                <span class="hljs-keyword">if</span> feat <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> count_feat:
                    count_feat[feat] = <span class="hljs-number">0</span>
                count_feat[feat] += <span class="hljs-number">1</span>
            plt.title(x)
            plt.bar(count_feat.keys(), count_feat.values(), color=<span class="hljs-string">'brown'</span>)
            <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> enumerate(count_feat.values()):
                plt.text(x, y, <span class="hljs-string">'%s'</span> %y)
            plt.show()


    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_feature_iris</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-comment">#value frequency with binning</span>
        means = {}
        stdevs = {}
        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> self.file:
            <span class="hljs-keyword">if</span> x==<span class="hljs-string">"class"</span>:
                <span class="hljs-keyword">continue</span>
            count_feat = {}
            <span class="hljs-keyword">for</span> feat <span class="hljs-keyword">in</span> self.file.loc[:, x]:
                <span class="hljs-keyword">if</span> feat <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> count_feat:
                    count_feat[feat] = <span class="hljs-number">0</span>
                count_feat[feat] += <span class="hljs-number">1</span>
            means[x] = statistics.mean(self.file.loc[:, x])
            stdevs[x] = statistics.stdev(self.file.loc[:, x])

            plt.title(x + <span class="hljs-string">" value frequency"</span>)
            count, binnn, patch = plt.hist(list(self.file.loc[:, x]), facecolor=<span class="hljs-string">'red'</span>,edgecolor=<span class="hljs-string">'black'</span>)

            dis = (binnn[<span class="hljs-number">1</span>]-binnn[<span class="hljs-number">0</span>])/<span class="hljs-number">2</span>
            <span class="hljs-keyword">for</span> (x, y) <span class="hljs-keyword">in</span> zip(binnn, count):
                plt.text(x+dis, y, <span class="hljs-string">'%s'</span> %y, ha=<span class="hljs-string">'center'</span>)
            plt.xticks(binnn)
            plt.xlabel(<span class="hljs-string">"cm"</span>)
            plt.ylabel(<span class="hljs-string">"num"</span>)
            plt.show()
            
        <span class="hljs-comment">#show means  </span>
        plt.title(<span class="hljs-string">"feature's"</span> + <span class="hljs-string">" mean"</span>)
        
        plt.bar(means.keys(), means.values(), color=<span class="hljs-string">'green'</span>)
        <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> enumerate( means.values() ):
            plt.text(x, y+<span class="hljs-number">0.1</span>, <span class="hljs-string">'%.5s'</span> %y, ha=<span class="hljs-string">'left'</span>)
        plt.show()
        <span class="hljs-comment">#show standard deviation</span>
        plt.title(<span class="hljs-string">"feature's"</span> + <span class="hljs-string">" stdev"</span>)
        plt.bar(stdevs.keys(), stdevs.values(), color=<span class="hljs-string">'aquamarine'</span>)
        <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> enumerate( stdevs.values() ):
            plt.text(x, y, <span class="hljs-string">'%.5s'</span> %y, ha=<span class="hljs-string">'left'</span>)
        plt.show()
    
</code></pre><p><em>In main function, do data preprocessing (import data in and delete missing value) first.<br>
Then, construct Naive_Bayes class and use the method inside to manipulate</em></p><pre><code class="python hljs"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-comment">#read file</span>
   
    mushroom_file = pd.read_csv(<span class="hljs-string">"mushroom.data.csv"</span>, header=<span class="hljs-keyword">None</span>, names=nn) <span class="hljs-comment">#categorical data</span>
    mushroom_file = mushroom_file.dropna()

    <span class="hljs-comment">#missing value</span>
    mushroom_file = mushroom_file.drop(<span class="hljs-string">"stalk-root"</span>, axis=<span class="hljs-number">1</span>)      

    iris_file = pd.read_csv(<span class="hljs-string">"iris.data.csv"</span>, header=<span class="hljs-keyword">None</span>, names=[<span class="hljs-string">"sepal_length"</span>, <span class="hljs-string">"sepal_width"</span>, <span class="hljs-string">"petal_length"</span>, <span class="hljs-string">"petal_width"</span>, <span class="hljs-string">"class"</span>])  <span class="hljs-comment">#numerical data</span>
    A = Naive_Bayes(iris_file, <span class="hljs-string">"iris"</span>)
    A.Holdout_validation(<span class="hljs-number">0.7</span>)
    A.k_fold_validation(<span class="hljs-number">3</span>)
    A.plot_feature_iris()

    A = Naive_Bayes(mushroom_file, <span class="hljs-string">"mushroom"</span>)
    A.Holdout_validation(<span class="hljs-number">0.7</span>)
    A.Holdout_validation(<span class="hljs-number">0.7</span>, <span class="hljs-string">"smooth"</span>)
    A.k_fold_validation(<span class="hljs-number">3</span>)
    A.k_fold_validation(<span class="hljs-number">3</span>, <span class="hljs-string">"smooth"</span>)
</code></pre><h2 id="Data-VisualizationDistribution"><a class="anchor hidden-xs" href="#Data-VisualizationDistribution" title="Data-VisualizationDistribution"><span class="octicon octicon-link"></span></a><strong>Data Visualization(Distribution):</strong></h2><ul>
<li>
<p><strong>Mushroom Dataset:</strong></p>
<ul>
<li><strong>value frequency for every feature:</strong><br>
<img src="https://i.imgur.com/RSFKOz8.png" alt=""><br>
<img src="https://i.imgur.com/2K654Yj.png" alt=""><br>
<img src="https://i.imgur.com/KWBF4rO.png" alt=""><br>
<img src="https://i.imgur.com/H0I7yWq.png" alt=""><br>
<img src="https://i.imgur.com/zqjwpFZ.png" alt=""><br>
<img src="https://i.imgur.com/Zpk5xTj.png" alt=""><br>
<img src="https://i.imgur.com/77aKtX3.png" alt=""><br>
<img src="https://i.imgur.com/9m50qO6.png" alt=""><br>
<img src="https://i.imgur.com/XOIp4S7.png" alt=""><br>
<img src="https://i.imgur.com/KbUBoGk.png" alt=""><br>
<img src="https://i.imgur.com/zRSlC7T.png" alt=""><br>
<img src="https://i.imgur.com/7Ev0Pql.png" alt=""><br>
<img src="https://i.imgur.com/SjhHAP6.png" alt=""><br>
<img src="https://i.imgur.com/zfWPLns.png" alt=""><br>
<img src="https://i.imgur.com/h9o41RZ.png" alt=""><br>
<img src="https://i.imgur.com/gjoT8RN.png" alt=""><br>
<img src="https://i.imgur.com/YKQQGiv.png" alt=""><br>
<img src="https://i.imgur.com/5cxxvDv.png" alt=""><br>
<img src="https://i.imgur.com/KWL0X7p.png" alt=""><br>
<img src="https://i.imgur.com/HFv8RKZ.png" alt=""><br>
<img src="https://i.imgur.com/X9VvXQV.png" alt=""></li>
</ul>
</li>
<li>
<p><strong>Iris Dataset:</strong></p>
<ul>
<li>
<p><strong>value frequency for every feature with binning :</strong><br>
<img src="https://i.imgur.com/shzuTmr.png" alt=""><br>
<img src="https://i.imgur.com/zeDd8Zc.png" alt=""><br>
<img src="https://i.imgur.com/NP6hBCy.png" alt=""><br>
<img src="https://i.imgur.com/fQozqvR.png" alt=""></p>
</li>
<li>
<p><strong>average for every feature:</strong><br>
<img src="https://i.imgur.com/FVFL3jY.png" alt=""></p>
</li>
<li>
<p><strong>standard deviation for every feature:</strong><br>
<img src="https://i.imgur.com/700FCDb.png" alt=""></p>
</li>
</ul>
</li>
</ul><h2 id="Results"><a class="anchor hidden-xs" href="#Results" title="Results"><span class="octicon octicon-link"></span></a><strong>Results:</strong></h2><ul>
<li>
<p><strong>execution result:</strong></p>
<ul>
<li>For data iris:<br>
<img src="https://i.imgur.com/eTKsfEw.png" alt=""></li>
<li>For data mushroom<br>
<img src="https://i.imgur.com/hVt9z49.png" alt=""></li>
</ul>
</li>
<li>
<p><strong>Mushroom Dataset:</strong><br>
<strong>1.Confusion Matrix for Holdout Validation:</strong></p>
<table>
<thead>
<tr>
<th>real \ precdict</th>
<th style="text-align:center">p</th>
<th style="text-align:center">e</th>
</tr>
</thead>
<tbody>
<tr>
<td>p</td>
<td style="text-align:center">918</td>
<td style="text-align:center">253</td>
</tr>
<tr>
<td>e</td>
<td style="text-align:center">123</td>
<td style="text-align:center">1144</td>
</tr>
</tbody>
</table>
<p><strong>Confusion Matrix for Holdout Validation with laplace smooth:</strong></p>
<table>
<thead>
<tr>
<th>real \ precdict</th>
<th style="text-align:center">p</th>
<th style="text-align:center">e</th>
</tr>
</thead>
<tbody>
<tr>
<td>p</td>
<td style="text-align:center">1041</td>
<td style="text-align:center">119</td>
</tr>
<tr>
<td>e</td>
<td style="text-align:center">9</td>
<td style="text-align:center">1269</td>
</tr>
</tbody>
</table>
<p><strong>Confusion Matrix for K-fold Validation:</strong></p>
<table>
<thead>
<tr>
<th>real \ precdict</th>
<th style="text-align:center">p</th>
<th style="text-align:center">e</th>
</tr>
</thead>
<tbody>
<tr>
<td>p</td>
<td style="text-align:center">962+1024+1033=3019</td>
<td style="text-align:center">296+318+275=889</td>
</tr>
<tr>
<td>e</td>
<td style="text-align:center">132+122+131=385</td>
<td style="text-align:center">1318+1244+1269=3831</td>
</tr>
</tbody>
</table>
<p><strong>Confusion Matrix for K-fold Validation with laplace smooth:</strong></p>
<table>
<thead>
<tr>
<th>real \ precdict</th>
<th style="text-align:center">p</th>
<th style="text-align:center">e</th>
</tr>
</thead>
<tbody>
<tr>
<td>p</td>
<td style="text-align:center">1168+1189+1185=3542</td>
<td style="text-align:center">116+107+122=345</td>
</tr>
<tr>
<td>e</td>
<td style="text-align:center">15+9+2=26</td>
<td style="text-align:center">1409+1403+1399=4211</td>
</tr>
</tbody>
</table>
<p><strong>2.Accuracy:</strong><br>
For Holdout Validation:  84.57752255947499%<br>
For Holdout Validation with laplace smooth: 94.74979491386382%<br>
For K-fold Validation:  84.3180699162974%<br>
For K-fold Validation with laplace smooth: 95.43328409650418%<br>
<strong>3.Sensitivity:</strong><br>
For Holdout Validation:</p>
<ul>
<li>p: 918/(918+253) = 78.394534585%</li>
<li>e: 1144/(1144+123) = 90.292028413%</li>
</ul>
<p>For Holdout Validation with laplace smooth:</p>
<ul>
<li>p: 1041/(1041+119) = 89.74137931%</li>
<li>e: 1269/(1269+9) = 99.295774647%</li>
</ul>
<p>For K-fold Validation:</p>
<ul>
<li>p: 3019/(3019+889) = 77.251791197%</li>
<li>e: 3831/(3831+385) = 90.868121442%</li>
</ul>
<p>For K-fold Validation with laplace smooth:</p>
<ul>
<li>p: 3542/(3545+345) = 91.053984575%</li>
<li>e: 4211/4237 = 99.386358272%</li>
</ul>
<p><strong>4.Precision:</strong><br>
For Holdout Validation:</p>
<ul>
<li>p: 918/(918+123) = 88.18443804%</li>
<li>e: 1144/(1144+253) = 81.889763779%</li>
</ul>
<p>For Holdout Validation with laplace smooth:</p>
<ul>
<li>p: 1041/(1041+9) = 99.142857142%</li>
<li>e: 1269/(1269+119) = 91.426512968%</li>
</ul>
<p>For K-fold Validation:</p>
<ul>
<li>p: 3019/(3019+385) = 88.689776733%</li>
<li>e: 3831/(3831+889) = 81.165254237%</li>
</ul>
<p>For K-fold Validation with laplace smooth:</p>
<ul>
<li>p: 3542/(3545+26) = 99.187902548%</li>
<li>e: 4211/(4211+345) = 92.427568042%</li>
</ul>
</li>
<li>
<p><strong>Iris Dataset:</strong><br>
<strong>1.Confusion Matrix for Holdout Validation(7:3):</strong></p>
<table>
<thead>
<tr>
<th>real \ predict</th>
<th style="text-align:center">Iris-setosa</th>
<th style="text-align:center">Iris-virginica</th>
<th style="text-align:center">Iris-versicolor</th>
</tr>
</thead>
<tbody>
<tr>
<td>Iris-setosa</td>
<td style="text-align:center">16</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>Iris-virginica</td>
<td style="text-align:center">0</td>
<td style="text-align:center">10</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td>Iris-versicolor</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">17</td>
</tr>
</tbody>
</table>
<p><strong>Confusion Matrix for K-fold Validation(k=3 and sum up the 3 results):</strong></p>
<table>
<thead>
<tr>
<th>real \ predict</th>
<th style="text-align:center">Iris-setosa</th>
<th style="text-align:center">Iris-virginica</th>
<th style="text-align:center">Iris-versicolor</th>
</tr>
</thead>
<tbody>
<tr>
<td>Iris-setosa</td>
<td style="text-align:center">16+14+16=46</td>
<td style="text-align:center">0+0+0</td>
<td style="text-align:center">0+0+0</td>
</tr>
<tr>
<td>Iris-virginica</td>
<td style="text-align:center">0+0+0</td>
<td style="text-align:center">20+17+21=58</td>
<td style="text-align:center">0+1+2=3</td>
</tr>
<tr>
<td>Iris-versicolor</td>
<td style="text-align:center">0+0+0</td>
<td style="text-align:center">0+0+2=2</td>
<td style="text-align:center">14+18+9=41</td>
</tr>
</tbody>
</table>
<p><strong>2.Accuracy:</strong><br>
For Holdout Validation: 95.55555555555556%<br>
For K-fold Validation: 96.66666666666667%</p>
<p><strong>3.Sensitivity:</strong><br>
For Holdout Validation:</p>
<ul>
<li>Iris-setosa: 16/16 = 100%</li>
<li>Iris-virginica: 10/11 = 90.90909090%</li>
<li>Iris-versicolor: 17/18 = 94.444444444%</li>
</ul>
<p>For K-fold Validation:</p>
<ul>
<li>Iris-setosa: 46/46 = 100%</li>
<li>Iris-virginica: 58/61 = 95.081967213%</li>
<li>Iris-versicolor: 41/43 = 95.348837209%</li>
</ul>
<p><strong>4.Precision:</strong><br>
For Holdout Validation:</p>
<ul>
<li>Iris-setosa: 100%</li>
<li>Iris-virginica: 10/11 = 90.90909090%</li>
<li>Iris-versicolor: 17/18 = 94.444444444%</li>
</ul>
<p>For K-fold Validation:</p>
<ul>
<li>Iris-setosa: 100%</li>
<li>Iris-virginica: 58/60 = 96.666666666%</li>
<li>Iris-versicolor: 41/44 = 93.18181818%</li>
</ul>
</li>
</ul><h2 id="Comparision-amp-Conclusion"><a class="anchor hidden-xs" href="#Comparision-amp-Conclusion" title="Comparision-amp-Conclusion"><span class="octicon octicon-link"></span></a><strong>Comparision &amp; Conclusion:</strong></h2><p>For Iris Data, the performance is good, the accuracy is very high for both method holdout validation and k-fold validation, accuracy can even reach to 100%. I think if we have more data to train, the performance will be better.<br>
For Mushroom Data, the performance is also good after doing laplace smooth, however, the performance without laplace smooth is not very well.<br>
In this part, I found a problem that “how to deal with the probability 0”, that is, when doing prediction, if a new attribute of a feature occured in testing data and not in training data, how to deal with it?<br>
I found that if we calculate posterior probability in log space,<br>
<img src="https://i.imgur.com/aoAPKpG.png" alt=""><br>
after asking professor and searching information, I handle it with log( P(Xi|Y) )= 0 ( P(Xi|Y) is zero) because of the undefintion of zero in log space.<br>
However, if we do this using multiplication,<br>
<img src="https://i.imgur.com/pfrSj1b.png" alt=""><br>
if one of the probability( P(Xi|Y) ) is zero, the posterior probability is zero too and I found that using the strategy we can gain very good performance, the accuracy can reach 99.9%. In the same way, if we give log( P(Xi|Y) )( P(Xi|Y) is zero) = -MAX (a very negative value), we can get the same performance.( Because the log function log(x) is becoming more negative when x approaching to zero).<br>
But, with smooth function, the problem will be solved because there is no P(Xi|Y) = 0</p><p>In conclusion, I think Navie Bayes is a powerful and simple method for classification. Giving the sufficient dataset, we can calculate the probability and do prediction with high performance. Furthermore, the computation for naive bayes will not so complicated.</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Machine-Learning-HW1-Report" title="Machine Learning HW1 Report">Machine Learning HW1 Report</a><ul class="nav">
<li><a href="#Explanation-of-code" title="Explanation of code:">Explanation of code:</a></li>
<li class=""><a href="#Data-VisualizationDistribution" title="Data Visualization(Distribution):">Data Visualization(Distribution):</a></li>
<li><a href="#Results" title="Results:">Results:</a></li>
<li><a href="#Comparision-amp-Conclusion" title="Comparision &amp; Conclusion:">Comparision &amp; Conclusion:</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Machine-Learning-HW1-Report" title="Machine Learning HW1 Report">Machine Learning HW1 Report</a><ul class="nav">
<li><a href="#Explanation-of-code" title="Explanation of code:">Explanation of code:</a></li>
<li class=""><a href="#Data-VisualizationDistribution" title="Data Visualization(Distribution):">Data Visualization(Distribution):</a></li>
<li><a href="#Results" title="Results:">Results:</a></li>
<li><a href="#Comparision-amp-Conclusion" title="Comparision &amp; Conclusion:">Comparision &amp; Conclusion:</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
